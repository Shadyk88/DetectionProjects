This detection is based on the article [https://www.hawk-eye.io/2023/04/threat-hunting-unauthorized-rdp-post-exploitation/] which highlights unauthorized RDP access.

Policy Recommendation:
It is highly recommened to ensure only authorized users are RDP'ing into your evnironment

Detection Recommendation:

Failed authentications via RDP

Splunk Sample Query:

index=wineventlog (however you have it indexed) sourcetype=* EventCode=4625 Logon_Type=10

QRadar Sample Query:

Log Source type = Microsoft Windows Security Event Log
AND when the event matches Event ID (depends on parsing) is any of 4625
AND when the event matches Logon Type (depends on parsing) is any of 10

Azure Sentinel Sample Query:


Successfully authentications via RDP from unauthorized user:

Splunk Sample Query:
index=wineventlog sourcetype=* EventCode=4624 Logon_type=10
users exists in this inputlookup (authorizedRDPusers)

QRadar Sample Query:
Log Source type = Microsoft Windows Security Event Log
AND when the event matches Event ID (depends on parsing) is any of 4624
AND when the event matches Logon Type (depends on parsing) is any of 10
AND when Username 







Successful RDP login outside of working hours:



Refernces:
https://www.ultimatewindowssecurity.com/securitylog/book/page.aspx?spid=chapter3
https://www.ultimatewindowssecurity.com/securitylog/encyclopedia/event.aspx?eventid=4625
https://www.hawk-eye.io/2023/04/threat-hunting-unauthorized-rdp-post-exploitation/
